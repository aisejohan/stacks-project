\input{preamble}

% OK, start here.
%
\begin{document}

\title{Relative Cycles}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents



\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we briefly explain how to get a theory of relative cycles
very similar to the one in \cite{SV}; the precise relationship between the
definitions will be explained in Remark \ref{remark-compare-SV}.



\section{Cycles relative to fields}
\label{section-relative-fields}

\noindent
Let $k$ be a field. Let $X$ be a locally algebraic scheme over $k$.
Let $r \geq 0$ be an integer. In this setting we have the group
$Z_r(X)$ of $r$-cycles on $X$, see
Chow Homology, Section \ref{chow-section-cycles}.

\medskip\noindent
Change of fields. For any field extension $k'/k$ there is a base change or
pullback map $Z_r(X) \to Z_r(X_{k'})$, see
Chow Homology, Section \ref{chow-section-change-base}.
Briefly, given an integral closed subscheme $Z \subset X$
of dimension $r$ we send $[Z] \in Z_r(X)$ to the $r$-cycle
$[Z_{k'}]_r \in Z_r(X_{k'})$ associated to the closed subscheme
$Z_{k'} \subset X_{k'}$ (of course in general $Z_{k'}$
is neither irreducible nor reduced). The base change map
$Z_r(X) \to Z_r(X_{k'})$ is always injective.

\begin{lemma}
\label{lemma-multiplicities-field-extension}
Let $K/k$ be a field extension. Let $Z$ be an integral locally algebraic
scheme over $k$. The multiplicity $m_{Z', Z_K}$ of an irreducible
component $Z' \subset Z_K$ is $1$ or a power of the characteristic of $k$.
\end{lemma}

\begin{proof}
If the characteristic of $k$ is zero, then $k$ is perfect and
the multiplicity is always $1$. Assume the characteristic of $k$ is $p > 0$.
Let $L$ be the function field of $X$. Then $L/k$ is a finitely generated
field extension. Then $K \otimes_k L$ is a Noetherian ring
(Algebra, Lemma \ref{}) and we
have to show that the length of $(K \otimes_k L)_\mathfrak q$
is a power of $p$.

\medskip\noindent
Let $L'/L$ be a finite purely inseparable extension, say of degree
$p^n$. Then $K \otimes_k L \subset K \otimes_k L'$ is a finite
free ring map of degree $p^n$. Hence for every minimal
prime $\mathfrak q$ as above there is a unique minimal prime
$\mathfrak q' \subset K \otimes_k L'$ lying over it and
$$
p^n \text{length}((K \otimes_k L)_\mathfrak q) =
[\kappa(\mathfrak q') : \kappa(\mathfrak q)]
\text{length}((K \otimes_k L')_{\mathfrak q'})
$$
by Algebra, Lemma \ref{algebra-lemma-pushdown-module} applied
to $M = (K \otimes_k L')_{\mathfrak q'} \cong
(K \otimes_k L)_{\mathfrak q}^{\oplus p^n}$.
Since $[\kappa(\mathfrak q') : \kappa(\mathfrak q)]$ is a power
of $p$ we conclude that it suffices to prove the
statement for $L'$ and $\mathfrak q'$.

\medskip\noindent
By the previous paragraph and Algebra, Lemma \ref{}
we may assume that we have a subfield $L/k'/k$
such that $L/k'$ is separable and $k'/k$ is finite
purely inseparable. In this case $\mathfrak q$ lies
over the unique prime ideal $\mathfrak p$ of $K \otimes_k k'$
and the ring map $K \otimes_k k' \to (K \otimes_k L)_\mathfrak q$
is formally smooth. Hence
$\text{length}((K \otimes_k L)_\mathfrak q) =
\text{length}(K \otimes_k k')$.
Since $K \otimes_k k'$ is finite free over $K$ of
rank a power of $p$ the same argument as before shows
that $\text{length}(K \otimes_k k')$ is a power of $p$.
\end{proof}

\begin{lemma}
\label{lemma-how-different}
Let $k$ be a field of characteristic $p > 0$ with perfect closure $k^{perf}$.
Let $X$ be an algebraic scheme over $k$. Let $r \geq 0$ be an integer.
The cokernel of the injective map $Z_r(X) \to Z_r(X_{k^{perf}})$ is an
$p$-power torsion module (More on Algebra, Definition
\ref{more-algebra-definition-f-power-torsion}).
\end{lemma}

\begin{proof}
Since $X$ is quasi-compact, the abelian group $Z_r(X)$ is free with basis
given by the integral closed subschemes of dimension $r$. Similarly for
$Z_r(X_{k^{perf}}$.
Since $X_{k^{perf}} \to X$ is a homeomorphism, it follows
that $Z_r(X) \to Z_r(X_{k^{perf}})$ is injective with torsion cokernel.
Every element in the cokernel is $p$-power torsion by
Lemma \ref{lemma-multiplicities-field-extension}.
\end{proof}





\section{Specialization of cycles}
\label{section-specialization}

\noindent
Let $R$ be a valuation ring with fraction field $K$ and residue field $\kappa$.
Let $X$ be a scheme locally of finite type over $R$. Let $r \geq 0$.
There is a specialization map
$$
sp_{X/R} : Z_r(X_K) \longrightarrow Z_r(X_\kappa)
$$
defined as follows. For an integral closed subscheme $Z \subset X_K$
of dimension $r$ we denote $\overline{Z}$ the scheme theoretic image
of $Z \to X$. Then we let $sp_{X/R}$ be the unique $\mathbf{Z}$-linear
map such that
$$
sp_{X/R}([Z]) = [\overline{Z}_\kappa]_r
$$
We briefly discuss why this is well defined. First, observe that the
morphism $X_K \to X$ is quasi-compact and hence the morphism $Z \to X$
is quasi-compact. Thus taking the scheme theoretic image of $Z \to X$
commutes with flat base change by
Morphisms, Lemma \ref{morphisms-lemma-flat-base-change-scheme-theoretic-image}.
In particular, base changing back to $X_K$ we see that $Z = \overline{Z}_K$.
Since $Z$ is integral, of course $\overline{Z}$ is integral too and
in fact is equal to the unique integral closed subscheme whose generic
point is the (image of the) generic point of $Z$. It follows from
Varieties, Lemma \ref{varieties-lemma-dominate-valuation-ring-dimension-fibres}
that $Z_\kappa$ is equidimensional of dimension $r$.

\begin{lemma}
\label{lemma-specialization-module}
Let $R$ be a valuation ring with fraction field $K$ and residue field $\kappa$.
Let $X$ be a scheme locally of finite type over $R$. Let $r \geq 0$.
Let $\mathcal{F}$ be a finite type, quasi-coherent $\mathcal{O}_X$-module
flat over $R$. Assume $\dim(\text{Supp}(\mathcal{F}_K)) \leq r$.
Then $\dim(\text{Supp}(\mathcal{F}_\kappa)) \leq r$ and
$$
sp_{X/R}([\mathcal{F}_K]_r) = [\mathcal{F}_\kappa]_r
$$
\end{lemma}

\begin{proof}
The statement on dimension follows from More on Morphisms, Lemma
\ref{more-morphisms-lemma-relative-dimension-support-flat}.
Let $x$ be a generic point of an irreducible component
of $\text{Supp}(\mathcal{F}_\kappa)$. Let $Z \subset X_\kappa$
be the integral closed subscheme with generic point $x$.
Assume $\dim(Z) = r$. Let $A = \mathcal{O}_{X, x}$ and $N = \mathcal{F}_x$.
For an $R$-module $M$ we denote $\overline{M} = M/\mathfrak m M$
where $\mathfrak m \subset R$ is the maximal ideal.
Then $N$ is a finite $A$-module flat over $R$ such that
the support of $\overline{N}$ in $\Spec(\overline{A})$ is
consists of the closed point (or is empty).
The finite module $N_K$ over the Noetherian ring $A_K$
has finite support and hence has a finite filtration
$$
0 = N_{K, 0} \subset N_{K, 1} \subset \ldots \subset N_{K, n} = N_K
$$
by submodules such that $N_{K, i}/N_{K, i - i} \cong \kappa(y_i)$
where the $y_i$ are the generic points of the irreducible components
of $\text{Supp}(\mathcal{F}_K)$ of dimension $r$ which specialize to $x$.
Let $y_i$ correspond to the prime ideal $\mathfrak p_i \subset A$.
Unwinding the definitions we have to show
$$
\sum \text{length}_{\overline{A}}(\overline{A/\mathfrak p_i})
=
\text{length}_{\overline{A}}(\overline{N})
$$
Since $R$ is a valuation ring, we can find a filtration
$$
0 = N_0 \subset N_1 \subset \ldots \subset N_n = N
$$
by submodules such that $N_i/N_{i - 1}$ is $R$-flat for all $i$
and such that $N_{K, i} = (N_i)_K$ for all $i$.
Observe that each $N/N_i$ is a finite $A$-module flat over the
valuation ring $R$ and hence of finite presentation over $A$
(More on Flatness, Lemma \ref{}). Thus $N_i/N_{i - 1}$ is a
finite $A$-module too (Algebra, Lemma \ref{}). By flatness we see that
$\overline{N}$ has a filtration whose subquotients are
$\overline{N_i/N_{i - 1}}$. Thus it suffices to show that given
an $R$-flat finite $A$-module $M$ with $M_K = \kappa(\mathfrak q_i)$
we have
$$
A/\mathfrak q_i \cong M
$$
Namely, by Lemma \ref{} we can find $x \in M$ which does not map
to zero in $\overline{M}$. This gives an injective map
$A/\mathfrak q_i \to M$ whose cokernel is flat (Lemma \ref{})
and hence zero (take $\otimes K$).
\end{proof}

\begin{lemma}
\label{lemma-specialization-closed}
Let $R$ be a valuation ring with fraction field $K$ and residue field $\kappa$.
Let $X$ be a scheme locally of finite type over $R$. Let $r \geq 0$.
Let $W \subset X$ be a closed subscheme flat over $R$. Assume
$\dim(W_K) \leq r$. Then $\dim(W_\kappa) \leq r$ and
$$
sp_{X/R}([W_K]_r) = [W_\kappa]_r
$$
\end{lemma}

\begin{proof}
Taking $\mathcal{F} = \mathcal{O}_W$ this is a special case of
Lemma \ref{lemma-specialization-module}. See
Chow Homology, Lemma \ref{chow-lemma-cycle-closed-coherent}.
\end{proof}

\begin{lemma}
\label{lemma-specialization-extension}
Let $R'/R$ be an extension of valuation rings inducing fraction field
extension $K'/K$ and residue field extension $\kappa'/\kappa$
(More on Algebra, Definition
\ref{more-algebra-definition-extension-valuation-rings}).
Let $X$ be locally of finite type over $R$. Denote $X' = X_{R'}$.
Then the diagram
$$
\xymatrix{
Z_r(X'_{K'}) \ar[rr]_{sp_{X'/R'}} & & Z_r(X'_{\kappa'}) \\
Z_r(X_K) \ar[rr]^{sp_{X/R}} \ar[u] & & Z_r(X_\kappa) \ar[u]
}
$$
commutes where $r \geq 0$ and the vertical arrows are base change maps.
\end{lemma}

\begin{proof}
Observe that $X'_{K'} = X_{K'} = X_K \times_{\Spec(K)} \Spec(K')$
and similarly for closed fibres, so that the vertical arrows indeed
make sense (see Section \ref{section-relative-fields}).
Now if $Z \subset X_K$ is an integral closed subscheme with
scheme theoretic image $\overline{Z} \subset X$, then we see that
$Z_{K'} \subset X_{K'}$ is a closed subscheme with scheme theoretic
image $\overline{Z}_{R'} \subset X_{R'}$. The base change of
$[Z]$ is $[Z_{K'}]_r = [\overline{Z}_{K'}]_r$ by definition. We have
$$
sp_{X/R}([Z]) = [\overline{Z}_\kappa]_r
\quad\text{and}\quad
sp_{X'/R'}([\overline{Z}_{K'}]_r) = [(\overline{Z}_{R'})_{\kappa'}]_r
$$
by Lemma \ref{lemma-specialization-module}. Since
$(\overline{Z}_{R'})_{\kappa'} = (\overline{Z}_\kappa)_{\kappa'}$
we conclude.
\end{proof}

\begin{lemma}
\label{lemma-specialization-flat-pullback}
Let $R$ be a valuation ring with fraction field $K$ and residue field $\kappa$.
Let $X$ be a scheme locally of finite type over $R$.
Let $f : X' \to X$ be a morphism which is locally of finite type, flat,
and of relative dimension $e$. 
Then the diagram
$$
\xymatrix{
Z_{r + e}(X'_K) \ar[rr]_{sp_{X'/R}} & & Z_{r + e}(X'_\kappa) \\
Z_r(X_K) \ar[rr]^{sp_{X/R}} \ar[u] & & Z_r(X_\kappa) \ar[u]
}
$$
commutes where $r \geq 0$ and the vertical arrows are given
by flat pullback.
\end{lemma}

\begin{proof}
Let $Z \subset X$ be an integral closed subscheme dominating $R$.
By the construction of $sp_{X/R}$ we see that $sp_{X/R}([Z_K]) = [Z_\kappa]_r$
and that this characterizes the specialization map.
Set $Z' = f^{-1}(Z) = X' \times_X Z$.
Since $R$ is a valuation ring, $Z$ is flat over $R$.
Hence $Z'$ is flat over $R$ and
$sp_{X'/R}([Z'_K]_{r + e}) = [Z'_\kappa]_{r + e}$
by Lemma \ref{lemma-specialization-closed}.
Since by Chow Homology, Lemma \ref{chow-lemma-pullback-coherent}
we have $f_K^*[Z_K] = [Z'_K]_{r + e}$ and
$f_\kappa^*[Z_\kappa]_r = [Z'_\kappa]_{r + e}$ we win.
\end{proof}

\begin{remark}
\label{remark-specialization-perfect}
Let $R$ be a valuation ring with fraction field $K$ and residue field $\kappa$.
Let $X$ be locally of finite type over $R$. Let $r \geq 0$ be an integer.
Then there is a canonical map
$$
sp_{X/R}^{perf} :
Z_r(X_{K^{perf}})
\longrightarrow
Z_r(X_{\kappa^{perf}})
$$
Namely, let $R'$ be the integral closure of $R$ in $K^{perf}$.
By More on Algebra, Lemma
\ref{more-algebra-lemma-valuation-ring-purely-inseparable}
we see that $R \subset R'$ is an extension of valuation rings and
$K^{perf}$ is the fraction field of $R'$. Set $X' = X_{R'}$.
Then we can use
$$
Z_r(X_{K^{perf}})
\xrightarrow{sp_{X'/R'}}
Z_r(X_{\kappa'})
\to
Z_r(X_{\kappa^{perf}})
$$
where $\kappa'$ is the residue field of $R'$.
Namely, the extension $\kappa'/\kappa$
is purely inseparable\footnote{If the characteristic
of $K$ is $p > 0$, then for all $a \in R'$ there is
a $p$-power $q$ such that $a^q \in R$.}. Thus there is a unique
embedding $\kappa' \subset \kappa^{perf}$ over $\kappa$.
\end{remark}

\begin{lemma}
\label{lemma-specialization-perfect}
Let $R$ be a valuation ring with fraction field $K$ and residue field $\kappa$.
Let $X$ be a scheme of finite type over $R$. Let $r \geq 0$ be an integer.
Let $\alpha \in Z_r(X_{K^{perf}})$ and $\beta \in Z_r(X_{\kappa^{perf}})$.
The following are equivalent
\begin{enumerate}
\item we have $sp_{X/R}^{perf}(\alpha) = \beta$,
\item there exists an $n > 0$ and $\alpha_0 \in Z_r(X_K)$
such that $n \alpha$ is the base change of $\alpha_0$
and $n \beta$ is the base change of $sp_{X/R}(\alpha_0)$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted. Hints: use Lemmas \ref{lemma-how-different} and
\ref{lemma-specialization-extension}.
\end{proof}









\section{Families of cycles on fibres}
\label{section-cycles-fibres}

\noindent
Let $f : X \to S$ be a morphism of schemes which is locally of finite type.
Let $r \geq 0$ be an integer. A
{\it family $\alpha$ of $r$-cycles on fibres of $X/S$} is a family
$$
\alpha = (\alpha_s)_{s \in S}
$$
indexed by the points $s$ of the scheme $S$ where
$$
\alpha_s \in Z_r(X_{\kappa(s)^{perf}})
\quad\text{with}\quad
X_{\kappa(s)^{perf}} = X_s \times_{\Spec(\kappa(s))} \Spec(\kappa(s)^{perf})
$$
is an $r$ cycle on the scheme theoretic fibre over the perfection of
the residue field. There are various constructions we can perform on
families of $r$-cycles on fibres.

\medskip\noindent
Base change. Let
$$
\xymatrix{
X' \ar[r] \ar[d] & X \ar[d] \\
S' \ar[r]^g & S
}
$$
be a catesian square of morphisms of schemes with $f$ locally of finite type.
Let $r \geq 0$ be an integer. Given a family $\alpha$ of $r$-cycles on
fibres of $X/S$ we define the {\it base change} $g^*\alpha$ of $\alpha$
to be the family
$$
g^*\alpha = (\alpha'_{s'})_{s' \in S'}
$$
where $\alpha'_{s'} \in Z_r(X'_{\kappa(s')^{perf}})$ is the base change
(or pullback) of the cycle $\alpha_s$ with $s' = g(s)$ as in
Section \ref{section-relative-fields} via the identitification
$$
X'_{\kappa(s')^{perf}} =
X_{\kappa(s)^{perf}} \times_{\Spec(\kappa(s)^{perf})} \Spec(\kappa(s')^{perf})
$$
of scheme theoretic fibres.

\medskip\noindent
Restriction. Let $f : X \to S$ be a morphism of schemes which is locally
of finite type. Let $r \geq 0$ be an integer. Let $U \subset X$ be an open
subscheme. Given a family $\alpha$ of $r$-cycles on fibres of $X/S$
we can define the {\it restriction} $\alpha|_U$ of $\alpha$ to be the family
$$
\alpha|_U = (\alpha_s|_{U_{\kappa(s)^{perf}}})_{s \in S}
$$
of restrictions to scheme theoretic fibres.

\medskip\noindent
Flat pullback. Let $f : X \to S$ be a morphism of schemes which is locally
of finite type. Let $r \geq 0$ be an integer. Let $h : X' \to X$ be a
flat morphism, locally of finite type, and of relative dimension $e$.
Let $r \geq 0$ be an integer. Given a family $\alpha$ of $r$-cycles
on fibres of $X/S$ we define the {\it flat pullback} $h^*\alpha$ of $\alpha$
to be the family of $(r + e)$-cycles on fibres
$$
h^*\alpha = (\alpha'_s)_{s \in S}
$$
where $\alpha'_s \in Z_{r + e}(X'_{\kappa(s)^{perf}})$ is the flat pullback
of the cycle $\alpha_s$ in $Z_r(X_{\kappa(s)^{perf}})$ by the flat morphism
$f_{\kappa(s)^{perf}} : X_{\kappa(s)^{perf}} \to X_{\kappa(s)^{perf}}$
of scheme theoretic fibres.

\begin{example}
\label{example-family-associated-module}
Let $f : X \to S$ be a morphism of schemes which is locally of finite type.
Let $r \geq 0$ be an integer. Let $\mathcal{F}$ be a quasi-coherent
$\mathcal{O}_X$-module of finite type. For $s \in S$ denote $\mathcal{F}_s$
and $\mathcal{F}_{\kappa(s)^{perf}}$
the pullback of $\mathcal{F}$ to $X_s$ and $X_{\kappa(s)^{perf}}$.
Assume $\dim(\text{Supp}(\mathcal{F}_s)) \leq r$ for all $s \in S$.
Then we can associate to $\mathcal{F}$ the family $[\mathcal{F}/X/S]_r$ of
$r$-cycles on fibres of $X/S$ defined by the formula
$$
[\mathcal{F}/X/S]_r = ([\mathcal{F}_{\kappa(s)^{perf}}]_r)_{s \in S}
$$
where $[\mathcal{F}_{\kappa(s)^{perf}}]_r$ is given by
Chow Homology, Definition
\ref{chow-definition-cycle-associated-to-coherent-sheaf}.
\end{example}

\begin{lemma}
\label{lemma-family-associated-module}
The construction in Example \ref{example-family-associated-module}
is compatible with base change, restriction,
and flat pullback.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{example}
\label{example-family-associated-closed}
Let $f : X \to S$ be a morphism of schemes which is locally of finite type.
Let $r \geq 0$ be an integer. Let $Z \subset X$ be a closed subscheme.
For $s \in S$ denote $Z_s$ and $Z_{\kappa(s)^{perf}}$
the inverse image of $Z$ in $X_s$ and $X_{\kappa(s)^{perf}}$.
Assume $\dim(Z_s) \leq r$ for all $s \in S$.
Then we can associate to $Z$ the family $[Z/X/S]_r$
of $r$-cycles on fibres of $X/S$ defined by the formula
$$
[Z/X/S]_r = ([Z_{\kappa(s)^{perf}}]_r)_{s \in S}
$$
where $[Z_{\kappa(s)^{perf}}]_r$ is given by
Chow Homology, Definition
\ref{chow-definition-cycle-associated-to-closed-subscheme}.
\end{example}

\begin{lemma}
\label{lemma-family-associated-closed}
The construction in Example \ref{example-family-associated-closed}
is compatible with base change, restriction,
and flat pullback.
\end{lemma}

\begin{proof}
Taking $\mathcal{F} = \mathcal{O}_Z$ this is a special case of
Lemma \ref{lemma-family-associated-module}. See
Chow Homology, Lemma \ref{chow-lemma-cycle-closed-coherent}.
\end{proof}

\begin{remark}[Support]
\label{remark-supports-family}
Let $f : X \to S$ be a morphism of schemes which is locally of finite type.
Let $r \geq 0$ be an integer. Let $\alpha$ be a family of $r$-cycles
on fibres of $X/S$. We define the {\it support} of $\alpha$ to be
$$
\text{Supp}(\alpha) = \bigcup\nolimits_{s \in S} \text{Supp}(\alpha_s) \subset X
$$
Here $\text{Supp}(\alpha_s) \subset X_{\kappa(s)^{perf}}$ is the
support of the cycle $\alpha_s$
(Chow Homology, Definition \ref{chow-definition-support-cycle})
and is viewed as
a closed subset of $X_s$ via the (universal) homeomorphism
$X_{\kappa(s)^{perf}} \to X_s$. The support $\text{Supp}(\alpha)$
is rarely a closed subset of $X$ (even for relative cycles as
defined later).
\end{remark}

\begin{lemma}
\label{lemma-support-family}
Taking the support as in Remark \ref{remark-supports-family}
is compatible with base change, restriction, and flat pullback.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-descend-family}
Let $f : X \to S$ be a morphism of schemes which is locally of finite type.
Let $r \geq 0$ be an integer. Let $g : S' \to S$ be a surjective morphism of
schemes and $X' = S' \times_S X$. Then
\begin{enumerate}
\item For families $\alpha_1$ and $\alpha_2$ of $r$-cycles on fibres of $X/S$
if $g^*\alpha_1 = g^*\alpha_2$, then $\alpha_1 = \alpha_2$.
\item Given a family $\alpha'$ of $r$-cycles on fibres of $X'/S'$ if
$\text{pr}_1^*\alpha' = \text{pr}_2^*\alpha'$ as families of
$r$-cycles on fibres of $(S' \times_S S') \times_S X / (S' \times_S S')$,
then there is a unique family $\alpha$ of $r$-cycles on fibres of $X/S$
such that $g^*\alpha = \alpha'$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) follows from the injectivity of the base change map discussed
in Section \ref{section-relative-fields}.

\medskip\noindent
Let $\alpha'$ be as in (2). Let $s \in S$ be a point. To prove (2)
we have to find an $\alpha_s$ in $Z_r(X_{\kappa(s)^{perf}})$
whose base change to $X_{\kappa(s')^{perf}}$ is equal to $\alpha'_{s'}$
for all $s' \in S'$ mapping to $s$. Thus we may replace $S$ by
$\Spec(\kappa(s)^{perf})$ and $S'$ by $\Spec(\kappa(s)^{perf}) \times_S S'$
to reduce to the case discussed in the next paragraph.

\medskip\noindent
Assume $S = \Spec(k)$ where $k$ is a perfect field.
Let $W' \subset X'$ be the support of $\alpha'$.
By Lemma \ref{lemma-support-family}
and our assumption on $\alpha'$ we see that
$$
p_1^{-1}(W') = p_2^{-1}(W')
$$
as subsets of $(S' \times_S S') \times_S X$ where $p_1$ and $p_2$
are the morphisms to $X' = S' \times_S X$ induced by the projections
$\text{pr}_1$ and $\text{pr}_2$ from $S' \times_S S'$ to $S'$.
By Descent, Lemma \ref{descent-lemma-equiv-fibre-product}
and the fact that $X' \times_X X' = (S' \times_S S') \times_S X$,
this means there exists a subset $W \subset X$ whose inverse image in
$X'$ is $W'$. Let $s' \in S'$ be a point (exists because $S'$ is not empty).
The morphism $s' \to S = \Spec(k)$ is universally open
(Morphisms, Lemma \ref{}), the subset
$\text{Supp}(\alpha'_{s'}) \subset X'_{s'}$ is closed and
is the inverse image of $W$. Hence we conclude $W \subset X$ is closed.
Let $Z \subset W$ be an irreducible component viewed as an integral
closed subscheme of $X$. Since $k$ is perfect, for any field extension
$K/k$ the base change $Z_K \subset X_K$ is a reduced closed subscheme
(this is the key fact that makes the argument work), see
Varieties, Lemma \ref{}. In particular
$Z_{\kappa(s')^{perf}} \subset X_{\kappa(s')^{perf}}$
is a reduced closed subscheme, which is locally a finite union of
irreducible components of $\text{Supp}(\alpha'_{s'})$.
In the next paragraph we will show that each of these irreducible
components have the same coefficient in $\alpha'_{s'}$ and that
this integer $n_Z$ is independent of the choice of $s' \in S'$.
This will show that $\alpha = \sum n_Z [Z]$ does the job.

\medskip\noindent
Let $s_1, s_2 \in S'$ and let $Z_1 \subset Z_{\kappa(s_1)^{perf}}$
and $Z_2 \subset Z_{\kappa(s_2)^{perf}}$ be irreducible components.
Since $Z_1 \to Z$ and $Z_2 \to Z$ are dominant, we can find a point
$\xi$ of $Z_1 \times_Z Z_2$ which maps to the generic point of both
$Z_1$ and $Z_2$. In fact, then $\xi$ is contained in $U_1 \times_Z U_2$
where $U_i \subset Z_i$ is the open which is the complement of the
other irreducible components of $Z_{\kappa(s_i)^{perf}}$. Then
$U_i \subset Z_{\kappa(s_i)^{perf}}$ is an open subscheme and
$U_1 \times_Z U_2$ is an open in the source of the morphism
$$
\Spec(\kappa(s_1)^{perf} \otimes_k \kappa(s_2)^{perf})
\times_{\Spec(k)} Z
\longrightarrow
\Spec(\kappa(s_1)^{perf} \otimes_k \kappa(s_2)^{perf})
$$
Thus we may also assume that $\xi$ is a generic point
of a fibre of this morphism (by replacing $\xi$ with a generalization
in its fibre if necessary). Let
$t \in \Spec(\kappa(s_1)^{perf} \otimes_k \kappa(s_2)^{perf})$
and $s'' \in S' \times_S S'$ be the images of $\xi$.
Then $\kappa(t)/\kappa(s'')$ is purely inseparable (details omitted).
We find that $\xi$ is a generic point of $Z_t = Z_{\kappa(t)}$
and hence corresponds to an irreducible component $Z''$
of $Z_{\kappa(s'')^{perf}}$.
Since $\alpha'_{s_1}$ and $\alpha'_{s_2}$ pull back to
the same $r$-cycle on $X_{\kappa(s'')^{perf}}$ by assumption, 
we see that the coefficient of
$Z_1$ in $\alpha'_{s_1}$ and the coefficient of $Z_2$
in $\alpha'_{s_2}$ must be equal.
\end{proof}

\begin{lemma}
\label{lemma-pullback-universally-bijective}
Let $g : S' \to S$ be a universally bijective morphism of schemes.
Let $f : X \to S$ be locally of finite type. Set $X' = S' \times_S X$.
Let $r \geq 0$. Then base change by $g$ determines a bijection
between the group of families of $r$-cycles on fibres of $X/S$ and
the group of families of $r$-cycles on fibres of $X'/S'$.
\end{lemma}

\begin{proof}
Holds because $g$ induces a bijection on points and isomorphisms
on perfect closures of residue fields. See Morphisms, Lemma
\ref{morphisms-lemma-universally-injective}.
\end{proof}







\section{Families of cycles and specializations}
\label{section-families-specialization}


\noindent
Let $f : X \to S$ be a morphism of schemes which is locally of finite type.
Let $r \geq 0$ be an integer. Give a family $\alpha$ of $r$-cycles on fibres
of $X/S$ we say $\alpha$ is {\it compatible with specializations} if
for every morphism $g : \Spec(R) \to S$ we have
$$
sp_{X/R}^{perf}(\alpha_\eta) = \alpha_0
$$
where $sp_{X/R}^{perf}$ is as in Remark \ref{remark-specialization-perfect}
and $\alpha_\eta$ (resp.\ $\alpha_0$) is the value of the base change
$g^*\alpha$ of $\alpha$ at the generic (resp.\ closed) point of $\Spec(R)$.

\begin{lemma}
\label{lemma-families-specialization}
In the situation above, if $\alpha$ is compatible with specializations,
then any restriction, base change, or flat pullback of $\alpha$ is compatible
with specializations.
\end{lemma}

\begin{proof}
For flat pullback use Lemma \ref{lemma-specialization-flat-pullback}.
Restriction is a special case of flat pullback. To see it holds for
base change use that base change is transitive.
\end{proof}

\begin{lemma}
\label{lemma-families-specialization-V-descent}
Let $f : X \to S$ be a morphism of schemes which is locally of finite type.
Let $r \geq 0$ be an integer. Let $\alpha$ be a family of $r$-cycles on fibres
of $X/S$. Let $\{g_i : S_i \to S\}$ be a V covering (Toppologies, Definition
\ref{topologies-definition-V-covering}). Then $\alpha$ is compatible
with specializations if and only if each base change $g_i^*\alpha$
is compatible with specializations.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-families-specialization-fppf-descent}
Let $f : X \to S$ be a morphism of schemes which is locally of finite type.
Let $r, e \geq 0$ be integers. Let $\alpha$ be a family of $r$-cycles on fibres
of $X/S$. Let $\{f_i : X_i \to X\}$ be a jointly surjective family
of flat morphisms, locally of finite type, and of relative dimension $e$.
Then $\alpha$ is compatible with specializations if and only if each flat
pullback $f_i^*\alpha$ is compatible with specializations.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-uniqueness-extension}
Let $f : X \to S$ be a morphism of schemes which is locally of finite type.
Let $r \geq 0$.
Let $\alpha$ and $\beta$ be families of $r$-cycles on fibres of $X/S$.
Let $g : S' \to S$ be a morphism of schemes. Assume
\begin{enumerate}
\item $g$ is quasi-compact and $g(S')$ is dense in $S$,
\item the base changes of $\alpha$ and $\beta$ to $S'$ are equal,
\item $\alpha$ and $\beta$ are compatible with specializations.
\end{enumerate}
Then $\alpha = \beta$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-family-associated-module-specialization}
In the situation of Example \ref{example-family-associated-module}
if $\mathcal{F}$ is flat over $S$, then $[\mathcal{F}/X/S]_r$
is compatible with specializations.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-family-associated-closed-specialization}
In the situation of Example \ref{example-family-associated-closed}
if $Z$ is flat over $S$, then $[Z/X/S]_r$ is compatible with
specialization.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-get-cycles}
Let $f : X \to S$ be a finite type morphism of schemes with $S$ Noetherian.
Let $r \geq 0$. Let $\alpha$ be a family of $r$-cycles on fibres of $X/S$
compatible with specializations. Then there exists a surjective proper
morphism $g : T \to S$, an integer $t$, integers
$n_1, \ldots, n_t \in \mathbf{Z}$, and closed subschemes
$Z_i \subset X_T$ flat and of relative dimension $\leq r$ over $T$ such that
$$
g^*\alpha = \sum n_i [Z_i/X_T/T]
$$
\end{lemma}

\begin{proof}
Suppose we have proper morphisms $g' : T' \to S$ and $g'' : T'' \to S$
such that $g  = g' \amalg g'' : T = T' \amalg T'' \to S$
is surjective and such that both $(g')^*\alpha$ and $(g'')^*\alpha$
have an expression as in the lemma. Claim: the lemma holds.
Namely, if $Z' \subset X_{T'}$ is a closed subscheme flat and of relative
dimension $\leq r$ over $T'$, then we may view $Z'$ as a closed subscheme
of $X_T$ flat over $T$ of relative dimension $\leq r$. Of course
then $[Z'/X_T/T]_r$ base changes to $[Z'/X_{T'}/T']_r$ over $T'$
and to $[\emptyset/X_{T''}/T'']_r = 0$ over $T''$. In this way,
we can combine the expressions for $(g')^*\alpha$ and $(g'')^*\alpha$
to an expression for $g^\alpha$ and we see the claim holds.

\medskip\noindent
Let $S = \bigcup S_j$ be the decomposition of $S$ into its irreducible
components. We may and do view $S_j$ as an integral closed subscheme of $S$.
By the discussion of the previous paragraph, it suffices to prove
the lemma for the pullback of $\alpha$ by $S_j \to S$. This reduces us
to the case discussed in the next paragraph.

\medskip\noindent
Assume $S$ is an integral scheme. Let $\eta \in S$ be the generic point
and let $K = \kappa(\eta)$ be the function field of $S$.
Then $\alpha_\eta$ is an $r$-cycle on $X_{K^{perf}}$.
By Chow Homology, Lemma \ref{chow-lemma-chow-limit}
there exists a finite subextension
$K^{perf}/L/K$ such that $\alpha_\eta$ comes from an $r$-cycle
$\beta$ on $X_L$. Write $\beta = \sum n_i[Y_i]$.
Choose a finite dominant morphism $S' \to S$ of integral schemes
such that the induced function field extension is $L/K$\footnote{This is
possible; one can first take the normalization $S'$ of $S$ in $\Spec(K)$
and if this isn't finite over $S$, then write $(S' \to S)_*\mathcal{O}_{S'}$
as a filtered colimit of finite $\mathcal{O}_S$-subalgebras using
Properties, Lemma
\ref{properties-lemma-integral-algebra-directed-colimit-finite}
and take the relative spectrum of one of these over $S$.}.
Then we may view $Y_i$ as a integral closed subscheme of the
generic fibre $X'_{\eta'}$ of the base change $X' = S' \times_S X$.
Taking the closure we obtain integral closed subschemes
$Y'_i \subset X'$ whose base change to $X'_{\eta'}$ is $Y_i$.
By generic flatness (for example Morphisms,
Proposition \ref{morphisms-proposition-generic-flatness}),
we see that $Z'_i$ is flat over an open $U$ of $S'$ for each $i$.
Applying More on Flatness, Lemma \ref{flat-lemma-flat-after-blowing-up}
we can find a $U$-admissible blowing up $T \to S'$
such that the strict transform $Z_i$ of $Y_i$ is flat over $T$.
Then $Z_i$ is a closed subscheme of $X'_T = X_T$.

\medskip\noindent
We claim that $T \to S$, the closed subschemes $Z_i$, and integers
$n_i$ do the job. Namely, set $\beta = \sum n_i[Z_i/X_T/T]$.
First, it is clear that the pullbacks of $\beta$ and $\alpha$
to $\Spec(L)$ are the same. Then $\beta$ and the pullback of
$\alpha$ by $T \to S$ are the same by Lemma \ref{lemma-uniqueness-extension}.
This finishes the proof.
\end{proof}









\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
